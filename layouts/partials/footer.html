<footer>
  <div style="display:flex; justify-content: center;">
    {{- range $index, $key := .Site.Params.Social -}}
    {{- if hasPrefix $key.icon "simple:" -}}
    <a class="soc" href="{{ $key.url }}" rel="me" title="{{ $key.name }}"><i class="si si-{{ substr $key.icon 7 }}"></i></a>
    {{- else -}}
    <a class="soc" href="{{ $key.url }}" rel="me" title="{{ $key.name }}">{{ template "feathericon" (dict "Icon" $key.icon "UseCDN" .Site.Params.useCDN) }}</a>
    {{- end -}}
    <a class="border"></a>
    {{- end -}}
  </div>
  <div class="footer-info" style="text-align: center;">
    {{ with .Site.Copyright }} {{ . }} {{ end }}
  </div>
</footer>

{{- if eq .Site.Params.mode "dark" }}
<script>
// Issue #3: Dark mode — always dark
document.documentElement.setAttribute('data-theme', 'dark');
</script>
{{- else if eq .Site.Params.mode "auto" }}
<script>
// Issue #3: Auto mode — follow system preference
(function() {
  var mq = window.matchMedia('(prefers-color-scheme: dark)');
  function apply(dark) {
    document.documentElement.setAttribute('data-theme', dark ? 'dark' : 'light');
  }
  apply(mq.matches);
  mq.addEventListener('change', function(e) { apply(e.matches); });
})();
</script>
{{- else if eq .Site.Params.mode "toggle" }}
<script>
// Issue #3: Toggle mode — restore saved preference, fall back to system
(function() {
  var saved = localStorage.getItem('theme-storage');
  var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  var theme = saved || (prefersDark ? 'dark' : 'light');
  document.documentElement.setAttribute('data-theme', theme);
  // Ensure darkModeStyle stylesheet matches the resolved theme
  var darkSheet = document.getElementById('darkModeStyle');
  if (darkSheet) {
    darkSheet.disabled = (theme !== 'dark');
  }
})();
</script>
{{- end }}
{{ if not hugo.IsServer }}
{{ template "_internal/google_analytics.html" . }}
{{ end }}
